# offLLM Symbiosis Deep Report (v6)

- Generated: **2025-12-22T08:26:55Z**
- Repo root: `/home/ales27pm/offLLM-1`
- Repo fingerprint: `git:2e8d69d81c2e5a0e35524b0032ccb553b4818d2c`

## Totals

- **files_seen**: 326
- **text_files_indexed**: 326
- **prompt_signal_files**: 25
- **tool_signal_files**: 37
- **telemetry_signal_files**: 44
- **rag_signal_files**: 53
- **eval_signal_files**: 76
- **ios_signal_files**: 77

## Where to search

### Prompts

- `scripts/reports/symbiosis_v6/symbiosis_deep_report.json`
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`
- `.vscode/PythonImportHelper-v2-Completion.json`
- `ios/MyOfflineLLMApp/Turbo/LLM.swift`
- `__tests__/promptBuilder.test.js`
- `ios/MyOfflineLLMApp/MLX/MLXModule.swift`
- `scripts/mlops/offllm_symbiosis_advisor_v4.py`
- `scripts/offllm_symbiosis_advisor_v4.py`
- `eval/run_prompt_regression.py`
- `src/core/AgentOrchestrator.js`
- `src/utils/buildPrompt.ts`
- `scripts/eval/run_prompt_regression.py`
- `scripts/ci/download-mlx-model.sh`
- `scripts/train_lora.py`
- `src/services/treeOfThought.js`
- `src/native/mlx.ts`
- `src/core/prompt/promptTemplates.json`
- `src/native/MLXModule.ts`
- `reports/symbiosis_plan.json`
- `reports/symbiosis_report.md`
- `docs/codebase-audit.md`
- `MLXModule.swift`
- `src/services/chat/mlxChat.ts`
- `scripts/eval/golden_prompts.json`
- `src/hooks/useMlxChat.ts`

### Tools Orchestration

- `.vscode/PythonImportHelper-v2-Completion.json`
- `docs/agent-architecture.md`
- `scripts/mlops/offllm_symbiosis_advisor_v4.py`
- `scripts/offllm_symbiosis_advisor_v4.py`
- `src/core/tools/ToolHandler.js`
- `eval/run_prompt_regression.py`
- `__tests__/toolRegistry.test.js`
- `package-lock.json`
- `scripts/eval/run_prompt_regression.py`
- `reports/symbiosis_plan.json`
- `reports/symbiosis_report.md`
- `__tests__/toolHandler.test.js`
- `reports/symbiosis_conductor/symbiosis_conductor_report.json`
- `reports/symbiosis_conductor/symbiosis_conductor_report.md`
- `src/App.js`
- `scripts/offllm_symbiosis_conductor_v1.py`
- `scripts/mlops/telemetry_to_sft.py`
- `reports/repo_index.json`
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.json`
- `src/core/AgentOrchestrator.js`
- `src/core/tools/ToolRegistry.js`
- `src/core/prompt/PromptBuilder.js`
- `eval/redteam_tool_injection.json`
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`
- `scripts/offllm_symbiosis_advisor_v3.py`
- … and 10 more

### Telemetry

- `reports/repo_index.json`
- `.vscode/PythonImportHelper-v2-Completion.json`
- `reports/symbiosis_conductor/symbiosis_conductor_report.json`
- `scripts/mlops/offllm_symbiosis_advisor_v4.py`
- `scripts/offllm_symbiosis_advisor_v4.py`
- `package-lock.json`
- `reports/symbiosis_conductor/symbiosis_conductor_report.md`
- `reports/symbiosis_plan.json`
- `docs/telemetry-events.md`
- `reports/symbiosis_report.md`
- `scripts/offllm_symbiosis_advisor_v6.py`
- `scripts/offllm_symbiosis_advisor_v3.py`
- `scripts/offllm_end_to_end_pipeline.py`
- `scripts/offllm_symbiosis_conductor_v1.py`
- `reports/symbiosis_conductor/fine_tune_manifest.json`
- `docs/agent-architecture.md`
- `scripts/mlops/telemetry_to_sft.py`
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.json`
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`
- `src/utils/telemetry.js`
- `reports/archive-result.json`
- `reports/ResultBundle_unsigned.json`
- `scripts/mlops/generate_retrieval_pairs.py`
- `scripts/eval/retrieval_eval.py`
- `scripts/eval/export_equivalence.py`
- … and 10 more

### Retrieval Rag

- `reports/repo_index.json`
- `.vscode/PythonImportHelper-v2-Completion.json`
- `scripts/mlops/offllm_symbiosis_advisor_v4.py`
- `scripts/offllm_symbiosis_advisor_v4.py`
- `reports/symbiosis_report.md`
- `src/utils/hnswVectorStore.js`
- `reports/symbiosis_plan.json`
- `scripts/offllm_symbiosis_advisor_v3.py`
- `scripts/offllm_end_to_end_pipeline.py`
- `reports/symbiosis_conductor/symbiosis_conductor_report.json`
- `reports/symbiosis_conductor/symbiosis_conductor_report.md`
- `android/app/src/main/cpp/llama_jni.cpp`
- `docs/agent-architecture.md`
- `scripts/offllm_symbiosis_advisor_v6.py`
- `scripts/offllm_symbiosis_conductor_v1.py`
- `scripts/eval/run_prompt_regression.py`
- `src/utils/sparseAttention.js`
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`
- `src/services/contextEngineer.js`
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.json`
- `__tests__/hnswVectorStore.test.js`
- `ios/MyOfflineLLMApp/Turbo/LLM.swift`
- `eval/retrieval_eval.py`
- `__tests__/contextEngineer.test.js`
- `__tests__/vectorMemory.test.js`
- … and 10 more

### Evaluation

- `reports/repo_index.json`
- `.vscode/PythonImportHelper-v2-Completion.json`
- `reports/symbiosis_conductor/symbiosis_conductor_report.md`
- `reports/symbiosis_conductor/symbiosis_conductor_report.json`
- `__tests__/AGENTS.md`
- `package-lock.json`
- `scripts/mlops/offllm_symbiosis_advisor_v4.py`
- `scripts/offllm_symbiosis_advisor_v4.py`
- `reports/symbiosis_plan.json`
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.json`
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`
- `reports/symbiosis_report.md`
- `scripts/offllm_symbiosis_conductor_v1.py`
- `scripts/offllm_symbiosis_advisor_v6.py`
- `reports/symbiosis_conductor/fine_tune_manifest.json`
- `scripts/offllm_symbiosis_advisor_v3.py`
- `__tests__/toolHandler.test.js`
- `src/services/AGENTS.md`
- `__tests__/telemetry.test.js`
- `docs/agent-architecture.md`
- `src/core/AGENTS.md`
- `AGENTS.md`
- `src/services/treeOfThought.js`
- `.github/workflows/e2e.yml`
- `docs/AGENTS.md`
- … and 10 more

### Ios Mlx Coreml

- `reports/build-log.txt`
- `.vscode/PythonImportHelper-v2-Completion.json`
- `project.yml`
- `scripts/ci/check_mlx_bridge.js`
- `scripts/ci/download-mlx-model.sh`
- `reports/archive-result.json`
- `reports/ResultBundle_unsigned.json`
- `.github/workflows/offllm_pipeline.yml`
- `ios/project.yml`
- `reports/repo_index.json`
- `.github/workflows/ios-deploy-testflight.yml`
- `.github/workflows/ios-build-signed-ipa.yml`
- `scripts/offllm_end_to_end_pipeline.py`
- `README.md`
- `__tests__/hfRepoDownloader.test.js`
- `reports/symbiosis_conductor/symbiosis_conductor_report.md`
- `scripts/offllm_symbiosis_advisor_v3.py`
- `ios/scripts/patch-mlx-metal-cxx17.sh`
- `scripts/detect_mlx_symbols.sh`
- `reports/symbiosis_plan.json`
- `src/App.js`
- `scripts/dev/doctor.sh`
- `ios/MyOfflineLLMApp/Turbo/LLM.swift`
- `reports/symbiosis_conductor/symbiosis_conductor_report.json`
- `reports/symbiosis_report.md`
- … and 10 more

### Todos Fixmes

- `scripts/mlops/offllm_symbiosis_advisor_v4.py`
- `scripts/offllm_symbiosis_advisor_v4.py`
- `reports/symbiosis_plan.json`
- `reports/symbiosis_report.md`

### Hot Churn

## Prompt drift clusters

### Cluster `2e2b37492819d1b8` (4 snippets, 1 files)

- marker-window@1183-1190: "end_line": 279, "kind": "marker-window", "preview": "], \"sample_previews\": [ \"marker-window@148-155: \\\"end_line\\\": 125, \\\"kind\\\": \\\"marker-window\\\", \\\"preview\\\": \\\"PROMPT_MARKERS =
- marker-window@1207-1214: "end_line": 309, "kind": "marker-window", "preview": "], \"sample_previews\": [ \"marker-window@164-171: \\\"end_line\\\": 178, \\\"kind\\\": \\\"marker-window\\\", \\\"preview\\\": \\\"PROMPT_MARKERS =
- marker-window@1231-1238: "end_line": 335, "kind": "marker-window", "preview": "\"end_line\": 115, \"kind\": \"marker-window\", \"preview\": \"], \\\"sample_previews\\\": [ \\\"marker-window@171-178: PROMPT_MARKERS = [ \\\\\
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.json`

### Cluster `09c74914c20610b2` (2 snippets, 1 files)

- marker-window@245-252: "files": ["reports/symbiosis_v6/symbiosis_deep_report.json"], "sample_previews": [ "marker-window@252-259: ], \"sample_previews\": [ \"marker-window@108-115: ], \\\"sample_previews\\\": [ \\\"marker
- marker-window@373-380: "files": ["reports/symbiosis_v6/symbiosis_deep_report.json"], "sample_previews": [ "marker-window@152-159: ], \"sample_previews\": [ \"marker-window@128-135: ], \\\"sample_previews\\\": [ \\\"marker
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.json`

### Cluster `1ebf87f552675352` (2 snippets, 1 files)

- marker-window@1263-1270: "end_line": 367, "kind": "marker-window", "preview": "\"end_line\": 155, \"kind\": \"marker-window\", \"preview\": \"\\\"end_line\\\": 125, \\\"kind\\\": \\\"marker-window\\\", \\\"preview\\\": \\\"PROMPT
- marker-window@1279-1286: "end_line": 383, "kind": "marker-window", "preview": "\"end_line\": 171, \"kind\": \"marker-window\", \"preview\": \"\\\"end_line\\\": 178, \\\"kind\\\": \\\"marker-window\\\", \\\"preview\\\": \\\"PROMPT
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.json`

### Cluster `2f71d5842cbeea87` (2 snippets, 1 files)

- marker-window@341-348: "files": ["reports/symbiosis_v6/symbiosis_deep_report.json"], "sample_previews": [ "marker-window@360-367: \"end_line\": 155, \"kind\": \"marker-window\", \"preview\": \"\\\"end_line\\\": 125, \\\"kind\\\": \
- marker-window@493-500: "files": ["reports/symbiosis_v6/symbiosis_deep_report.json"], "sample_previews": [ "marker-window@376-383: \"end_line\": 171, \"kind\": \"marker-window\", \"preview\": \"\\\"end_line\\\": 178, \\\"kind\\\": \
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.json`

### Cluster `4e33c2474578ad15` (2 snippets, 1 files)

- marker-window@943-950: "end_line": 300, "kind": "marker-window", "preview": "- `reports/symbiosis_v6/symbiosis_deep_report.json`:108-115 [marker-window] ], \"sample_previews\": [ \"marker-window@171-178: PROMPT_MARKERS = [ \\\"SYSTEM
- marker-window@959-966: "end_line": 302, "kind": "marker-window", "preview": "- `reports/symbiosis_v6/symbiosis_deep_report.json`:128-135 [marker-window] ], \"sample_previews\": [ \"marker-window@118-125: PROMPT_MARKERS = [ \\\"SYSTEM
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.json`

### Cluster `5435493328f33e19` (2 snippets, 1 files)

- marker-window@629-636: "files": ["reports/symbiosis_v6/symbiosis_deep_report.md"], "sample_previews": [ "marker-window@297-304: - `reports/symbiosis_v6/symbiosis_deep_report.json`:148-155 [marker-window] \"end_line\": 125, \"kind\": \"marker-w
- marker-window@637-644: "files": ["reports/symbiosis_v6/symbiosis_deep_report.md"], "sample_previews": [ "marker-window@299-306: - `reports/symbiosis_v6/symbiosis_deep_report.json`:164-171 [marker-window] \"end_line\": 178, \"kind\": \"marker-w
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.json`

### Cluster `7f8ec809e1697aab` (2 snippets, 1 files)

- marker-window@911-918: "end_line": 296, "kind": "marker-window", "preview": "## Prompt snippet index (sample) - `mlops/offllm_symbiosis_advisor_v4.py`:171-178 [marker-window] PROMPT_MARKERS = [ \"SYSTEM_PROMPT\", \"system prompt\", \"You a
- marker-window@919-926: "end_line": 297, "kind": "marker-window", "preview": "## Prompt snippet index (sample) - `mlops/offllm_symbiosis_advisor_v4.py`:171-178 [marker-window] PROMPT_MARKERS = [ \"SYSTEM_PROMPT\", \"system prompt\", \"You a
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.json`

### Cluster `835a79e0e8b0d9f7` (2 snippets, 1 files)

- marker-window@320-327: - `mlops/offllm_symbiosis_advisor_v4.py`:171-178 [marker-window] PROMPT_MARKERS = [ "SYSTEM_PROMPT", "system prompt", "You are", "### Instruction", "### Response", "prompt_template", "PROMPT_TEMPLATE", - `mlops/offllm_symbiosis_advisor_v4.p
- marker-window@321-328: - `mlops/offllm_symbiosis_advisor_v4.py`:171-178 [marker-window] PROMPT_MARKERS = [ "SYSTEM_PROMPT", "system prompt", "You are", "### Instruction", "### Response", "prompt_template", "PROMPT_TEMPLATE", - `mlops/offllm_symbiosis_advisor_v4.p
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`

### Cluster `840c58400453e525` (2 snippets, 1 files)

- marker-window@344-351: - `reports/symbiosis_v6/symbiosis_deep_report.md`:293-300 [marker-window] - `reports/symbiosis_v6/symbiosis_deep_report.json`:108-115 [marker-window] ], "sample_previews": [ "marker-window@171-178: PROMPT_MARKERS = [ \"SYSTEM_PROMPT\", \"sy
- marker-window@346-351: - `reports/symbiosis_v6/symbiosis_deep_report.md`:295-302 [marker-window] - `reports/symbiosis_v6/symbiosis_deep_report.json`:128-135 [marker-window] ], "sample_previews": [ "marker-window@118-125: PROMPT_MARKERS = [ \"SYSTEM_PROMPT\", \"sy
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`

### Cluster `8ef7cce2632d6c88` (2 snippets, 1 files)

- marker-window@1087-1094: "end*line": 159, "kind": "marker-window", "preview": "], \"sample_previews\": [ \"marker-window@128-135: ], \\\"sample_previews\\\": [ \\\"marker-window@118-125: PROMPT_MARKERS = [ \\\\\\\"SYSTEM*
- marker-window@1167-1174: "end*line": 259, "kind": "marker-window", "preview": "], \"sample_previews\": [ \"marker-window@108-115: ], \\\"sample_previews\\\": [ \\\"marker-window@171-178: PROMPT_MARKERS = [ \\\\\\\"SYSTEM*
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.json`

### Cluster `b2eefc7acccf2205` (2 snippets, 1 files)

- marker-window@453-460: "files": ["reports/symbiosis_v6/symbiosis_deep_report.json"], "sample_previews": [ "marker-window@302-309: ], \"sample_previews\": [ \"marker-window@164-171: \\\"end_line\\\": 178, \\\"kind\\\": \\\"marker-
- marker-window@549-556: "files": ["reports/symbiosis_v6/symbiosis_deep_report.json"], "sample_previews": [ "marker-window@272-279: ], \"sample_previews\": [ \"marker-window@148-155: \\\"end_line\\\": 125, \\\"kind\\\": \\\"marker-
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.json`

### Cluster `bf78b836d9ac825e` (2 snippets, 1 files)

- marker-window@340-347: - `reports/symbiosis_v6/symbiosis_deep_report.md`:289-296 [marker-window] ## Prompt snippet index (sample) - `mlops/offllm_symbiosis_advisor_v4.py`:171-178 [marker-window] PROMPT_MARKERS = [ "SYSTEM_PROMPT", "system prompt", "You are", "###
- marker-window@341-348: - `reports/symbiosis_v6/symbiosis_deep_report.md`:290-297 [marker-window] ## Prompt snippet index (sample) - `mlops/offllm_symbiosis_advisor_v4.py`:171-178 [marker-window] PROMPT_MARKERS = [ "SYSTEM_PROMPT", "system prompt", "You are", "###
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`

### Cluster `e6437d3d2114acff` (2 snippets, 1 files)

- marker-window@261-268: "files": ["reports/symbiosis_v6/symbiosis_deep_report.json"], "sample_previews": [ "marker-window@328-335: \"end_line\": 115, \"kind\": \"marker-window\", \"preview\": \"], \\\"sample_previews\\\": [
- marker-window@653-660: "files": ["reports/symbiosis_v6/symbiosis_deep_report.json"], "sample_previews": [ "marker-window@344-351: \"end_line\": 135, \"kind\": \"marker-window\", \"preview\": \"], \\\"sample_previews\\\": [
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.json`

### Cluster `e83072aa29676220` (2 snippets, 1 files)

- marker-window@173-180: "files": ["reports/symbiosis_v6/symbiosis_deep_report.md"], "sample_previews": [ "marker-window@295-302: - `reports/symbiosis_v6/symbiosis_deep_report.json`:128-135 [marker-window] ], \"sample_previews\": [ \"mar
- marker-window@581-588: "files": ["reports/symbiosis_v6/symbiosis_deep_report.md"], "sample_previews": [ "marker-window@293-300: - `reports/symbiosis_v6/symbiosis_deep_report.json`:108-115 [marker-window] ], \"sample_previews\": [ \"mar
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.json`

### Cluster `eab5bd312b73dc43` (2 snippets, 1 files)

- marker-window@975-982: "end_line": 304, "kind": "marker-window", "preview": "- `reports/symbiosis_v6/symbiosis_deep_report.json`:148-155 [marker-window] \"end_line\": 125, \"kind\": \"marker-window\", \"preview\": \"PROMPT_MARKERS = [
- marker-window@991-998: "end_line": 306, "kind": "marker-window", "preview": "- `reports/symbiosis_v6/symbiosis_deep_report.json`:164-171 [marker-window] \"end_line\": 178, \"kind\": \"marker-window\", \"preview\": \"PROMPT_MARKERS = [
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.json`

## Action items

### Unify prompt surfaces into versioned templates (high)

**Why:** Prompt drift breaks alignment between runtime, fine-tuning, and eval.

**Next steps:**

- Create prompts/v1/\*.json and a registry.json (id+version).
- Load prompts at runtime by id+version; log prompt_id+version into telemetry.
- Add CI lint: fail if new system prompts are added outside registry.

**Where:**

- `scripts/reports/symbiosis_v6/symbiosis_deep_report.json`
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`
- `.vscode/PythonImportHelper-v2-Completion.json`
- `ios/MyOfflineLLMApp/Turbo/LLM.swift`
- `__tests__/promptBuilder.test.js`
- `ios/MyOfflineLLMApp/MLX/MLXModule.swift`
- `scripts/mlops/offllm_symbiosis_advisor_v4.py`
- `scripts/offllm_symbiosis_advisor_v4.py`
- `eval/run_prompt_regression.py`
- `src/core/AgentOrchestrator.js`
- `src/utils/buildPrompt.ts`
- `scripts/eval/run_prompt_regression.py`
- `scripts/ci/download-mlx-model.sh`
- `scripts/train_lora.py`
- `src/services/treeOfThought.js`

### Standardise telemetry schema and redaction (high)

**Why:** Telemetry is the bridge between what the app did and what the model should learn.

**Next steps:**

- Define an event schema for model interactions.
- Centralise PII redaction (emails, tokens, keys).
- Implement telemetry→SFT and telemetry→retrieval pairs transforms.

**Where:**

- `reports/repo_index.json`
- `.vscode/PythonImportHelper-v2-Completion.json`
- `reports/symbiosis_conductor/symbiosis_conductor_report.json`
- `scripts/mlops/offllm_symbiosis_advisor_v4.py`
- `scripts/offllm_symbiosis_advisor_v4.py`
- `package-lock.json`
- `reports/symbiosis_conductor/symbiosis_conductor_report.md`
- `reports/symbiosis_plan.json`
- `docs/telemetry-events.md`
- `reports/symbiosis_report.md`
- `scripts/offllm_symbiosis_advisor_v6.py`
- `scripts/offllm_symbiosis_advisor_v3.py`
- `scripts/offllm_end_to_end_pipeline.py`
- `scripts/offllm_symbiosis_conductor_v1.py`
- `reports/symbiosis_conductor/fine_tune_manifest.json`

### Isolate retrieval + chunking into a single library surface (med)

**Why:** Stable chunking/embedding settings prevent offline vs runtime mismatch.

**Next steps:**

- Extract chunking rules into one module with golden tests.
- Log retrieval traces into telemetry.
- Train embeddings/LLM2Vec with the same chunk distribution used at runtime.

**Where:**

- `reports/repo_index.json`
- `.vscode/PythonImportHelper-v2-Completion.json`
- `scripts/mlops/offllm_symbiosis_advisor_v4.py`
- `scripts/offllm_symbiosis_advisor_v4.py`
- `reports/symbiosis_report.md`
- `src/utils/hnswVectorStore.js`
- `reports/symbiosis_plan.json`
- `scripts/offllm_symbiosis_advisor_v3.py`
- `scripts/offllm_end_to_end_pipeline.py`
- `reports/symbiosis_conductor/symbiosis_conductor_report.json`
- `reports/symbiosis_conductor/symbiosis_conductor_report.md`
- `android/app/src/main/cpp/llama_jni.cpp`
- `docs/agent-architecture.md`
- `scripts/offllm_symbiosis_advisor_v6.py`
- `scripts/offllm_symbiosis_conductor_v1.py`

### Make evaluation first-class (golden set + regression gates) (high)

**Why:** Fine-tuning without a regression gate is just vibe-training.

**Next steps:**

- Create a golden eval suite: tool parsing, JSON validity, groundedness/citations, refusal correctness.
- Add an offline eval CLI and a CI job that blocks regressions.
- Version eval cases alongside prompt templates.

**Where:**

- `reports/repo_index.json`
- `.vscode/PythonImportHelper-v2-Completion.json`
- `reports/symbiosis_conductor/symbiosis_conductor_report.md`
- `reports/symbiosis_conductor/symbiosis_conductor_report.json`
- `__tests__/AGENTS.md`
- `package-lock.json`
- `scripts/mlops/offllm_symbiosis_advisor_v4.py`
- `scripts/offllm_symbiosis_advisor_v4.py`
- `reports/symbiosis_plan.json`
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.json`
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`
- `reports/symbiosis_report.md`
- `scripts/offllm_symbiosis_conductor_v1.py`
- `scripts/offllm_symbiosis_advisor_v6.py`
- `reports/symbiosis_conductor/fine_tune_manifest.json`

### Harden tool-calling boundaries and injection resistance (med)

**Why:** Tool-calling is the highest-risk surface; harden and train for safe behaviour.

**Next steps:**

- Validate tool args against JSON schema before execution.
- Capability-based allowlists.
- Add red-team eval set: injection, schema smuggling, exfil attempts.

**Where:**

- `.vscode/PythonImportHelper-v2-Completion.json`
- `docs/agent-architecture.md`
- `scripts/mlops/offllm_symbiosis_advisor_v4.py`
- `scripts/offllm_symbiosis_advisor_v4.py`
- `src/core/tools/ToolHandler.js`
- `eval/run_prompt_regression.py`
- `__tests__/toolRegistry.test.js`
- `package-lock.json`
- `scripts/eval/run_prompt_regression.py`
- `reports/symbiosis_plan.json`
- `reports/symbiosis_report.md`
- `__tests__/toolHandler.test.js`
- `reports/symbiosis_conductor/symbiosis_conductor_report.json`
- `reports/symbiosis_conductor/symbiosis_conductor_report.md`
- `src/App.js`

## Prompt snippet index (sample)

- `scripts/offllm_symbiosis_advisor_v4.py`:118-125 [marker-window] PROMPT_MARKERS = [ "SYSTEM_PROMPT", "system prompt", "You are", "### Instruction", "### Response", "prompt_template", "PROMPT_TEMPLATE", "few-shot", "chain-of-thought", "tool_calls", "function_call", "ReAct", "scratchpad", "tool
- `scripts/offllm_symbiosis_advisor_v4.py`:478-485 [marker-window] axes.append(FineTuneAxis( axis="Product voice + prompt adherence", goal="Consistent style, safety rules, and system prompt compliance across versions.", dataset_sources=(["prompt_registry: versioned templates"] if se
- `docs/codebase-audit.md`:28-35 [marker-window] ### Prompt routing and tool execution - `PromptBuilder` normalises tool metadata before injecting it into the system prompt so downstream parsing keeps deterministic ordering and excludes malformed entries.【F:src/core/prompt/PromptBuilder.
- `scripts/mlops/offllm_symbiosis_advisor_v4.py`:171-178 [marker-window] PROMPT_MARKERS = [ "SYSTEM_PROMPT", "system prompt", "You are", "### Instruction", "### Response", "prompt_template", "PROMPT_TEMPLATE",
- `scripts/mlops/offllm_symbiosis_advisor_v4.py`:629-636 [marker-window] FineTuneAxis( axis="Product voice + prompt adherence", goal="Consistent style, safety rules, and system prompt compliance across versions.", dataset_sources=( ["prompt_registry: versioned
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`:148-155 [marker-window] ### Cluster `c109d064a17e6c7c` (2 snippets, 1 files) - marker-window@289-296: ## Prompt snippet index (sample) - `mlops/offllm_symbiosis_advisor_v4.py`:171-178 [marker-window] PROMPT_MARKERS = [ "SYSTEM_PROMPT", "system prompt", "You are",
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`:149-156 [marker-window] - marker-window@289-296: ## Prompt snippet index (sample) - `mlops/offllm_symbiosis_advisor_v4.py`:171-178 [marker-window] PROMPT_MARKERS = [ "SYSTEM_PROMPT", "system prompt", "You are", "### Instruction", "### Response", "prompt_template",
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`:154-161 [marker-window] ### Cluster `0079681099007259` (1 snippets, 1 files) - marker-window@170-177: ### Cluster `5347bf6411216d89` (1 snippets, 1 files) - marker-window@191-196: ## Prompt snippet index (sample) - `offllm_symbiosis_advisor_v4.py`:118-125 [marker
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`:159-166 [marker-window] ### Cluster `025aee25afc4fefe` (1 snippets, 1 files) - marker-window@295-302: - `reports/symbiosis_v6/symbiosis_deep_report.json`:128-135 [marker-window] ], "sample_previews": [ "marker-window@118-125: PROMPT_MARKERS = [ \"SYSTEM_PROMPT\",
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`:164-171 [marker-window] ### Cluster `037d30adddf384db` (1 snippets, 1 files) - marker-window@302-309: - `offllm_symbiosis_advisor_v4.py`:478-485 [marker-window] axes.append(FineTuneAxis( axis="Product voice + prompt adherence", goal="Consistent style, safety rule
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`:169-176 [marker-window] ### Cluster `0836aae38906f2ac` (1 snippets, 1 files) - marker-window@424-431: "end_line": 116, "kind": "marker-window", "preview": "### Cluster `83a9f1c3daa7e538` (1 snippets, 1 files) - marker-window@118-125: PROMPT_MARKERS = [ \"SYSTEM_P
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`:174-181 [marker-window] ### Cluster `1046781b8897a8ce` (1 snippets, 1 files) - marker-window@192-199: ], "sample_previews": [ "marker-window@109-116: ### Cluster `83a9f1c3daa7e538` (1 snippets, 1 files) - marker-window@118-125: PROMPT_MARKERS = [ \"SYSTEM_PROMPT\
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`:179-186 [marker-window] ### Cluster `170e0d18f54b6720` (1 snippets, 1 files) - marker-window@320-327: "end_line": 636, "kind": "marker-window", "preview": "FineTuneAxis( axis=\"Product voice + prompt adherence\", goal=\"Consistent style, safety rules, and system
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`:194-201 [marker-window] ### Cluster `1b2f068add2f841b` (1 snippets, 1 files) - marker-window@301-308: - `offllm_symbiosis_advisor_v4.py`:118-125 [marker-window] PROMPT_MARKERS = [ "SYSTEM_PROMPT", "system prompt", "You are", "### Instruction", "### Response", "pr
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`:204-211 [marker-window] ### Cluster `2184c736c8d90c0d` (1 snippets, 1 files) - marker-window@252-259: ], "sample_previews": [ "marker-window@108-115: ], \"sample_previews\": [ \"marker-window@171-178: PROMPT_MARKERS = [ \\\"SYSTEM_PROMPT\\\", \\\"system prompt\\\
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`:214-221 [marker-window] ### Cluster `2960583c132d9c01` (1 snippets, 1 files) - marker-window@328-335: "end_line": 115, "kind": "marker-window", "preview": "], \"sample_previews\": [ \"marker-window@171-178: PROMPT_MARKERS = [ \\\"SYSTEM_PROMPT\\\", \\\"system pro
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`:319-326 [marker-window] ## Prompt snippet index (sample) - `mlops/offllm_symbiosis_advisor_v4.py`:171-178 [marker-window] PROMPT_MARKERS = [ "SYSTEM_PROMPT", "system prompt", "You are", "### Instruction", "### Response", "prompt_template", "PROMPT_TEMPLATE", - `m
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`:320-327 [marker-window] - `mlops/offllm_symbiosis_advisor_v4.py`:171-178 [marker-window] PROMPT_MARKERS = [ "SYSTEM_PROMPT", "system prompt", "You are", "### Instruction", "### Response", "prompt_template", "PROMPT_TEMPLATE", - `mlops/offllm_symbiosis_advisor_v4.p
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`:321-328 [marker-window] - `mlops/offllm_symbiosis_advisor_v4.py`:171-178 [marker-window] PROMPT_MARKERS = [ "SYSTEM_PROMPT", "system prompt", "You are", "### Instruction", "### Response", "prompt_template", "PROMPT_TEMPLATE", - `mlops/offllm_symbiosis_advisor_v4.p
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`:322-329 [marker-window] - `mlops/offllm_symbiosis_advisor_v4.py`:629-636 [marker-window] FineTuneAxis( axis="Product voice + prompt adherence", goal="Consistent style, safety rules, and system prompt compliance across versions.", dataset_sources=( ["prompt_registr
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`:325-332 [marker-window] - `reports/symbiosis_v6/symbiosis_deep_report.md`:146-153 [marker-window] ### Cluster `037d30adddf384db` (1 snippets, 1 files) - marker-window@194-196: - `offllm_symbiosis_advisor_v4.py`:478-485 [marker-window] axes.append(FineTuneAxis( axi
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`:326-333 [marker-window] - `reports/symbiosis_v6/symbiosis_deep_report.md`:150-157 [marker-window] ### Cluster `170e0d18f54b6720` (1 snippets, 1 files) - marker-window@172-179: "end_line": 636, "kind": "marker-window", "preview": "FineTuneAxis( axis=\"Product voice
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`:327-334 [marker-window] - `reports/symbiosis_v6/symbiosis_deep_report.md`:154-161 [marker-window] ### Cluster `1b2f068add2f841b` (1 snippets, 1 files) - marker-window@193-196: - `offllm_symbiosis_advisor_v4.py`:118-125 [marker-window] PROMPT_MARKERS = [ "SYSTEM_PR
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`:328-335 [marker-window] - `reports/symbiosis_v6/symbiosis_deep_report.md`:158-165 [marker-window] ### Cluster `2bc90a9d8aee6b1a` (1 snippets, 1 files) - marker-window@128-135: ], "sample_previews": [ "marker-window@118-125: PROMPT_MARKERS = [ \"SYSTEM_PROMPT\", \"
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`:329-336 [marker-window] - `reports/symbiosis_v6/symbiosis_deep_report.md`:162-169 [marker-window] ### Cluster `2e867b002b71be04` (1 snippets, 1 files) - marker-window@171-178: PROMPT_MARKERS = [ "SYSTEM_PROMPT", "system prompt", "You are", "### Instruction", "###
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`:330-337 [marker-window] - `reports/symbiosis_v6/symbiosis_deep_report.md`:166-173 [marker-window] ### Cluster `4d2b199a17ac1c28` (1 snippets, 1 files) - marker-window@101-108: ### Cluster `2e867b002b71be04` (1 snippets, 1 files) - marker-window@171-178: PROMPT_MAR
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`:333-340 [marker-window] - `reports/symbiosis_v6/symbiosis_deep_report.md`:178-185 [marker-window] ### Cluster `67a2e521030bf0d2` (1 snippets, 1 files) - marker-window@138-145: ], "sample_previews": [ "marker-window@478-485: axes.append(FineTuneAxis( axis=\"Product
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`:334-341 [marker-window] - `reports/symbiosis_v6/symbiosis_deep_report.md`:182-189 [marker-window] ### Cluster `76a4db4988b50e70` (1 snippets, 1 files) - marker-window@113-120: ### Cluster `c73fc5fe43476bd2` (1 snippets, 1 files) - marker-window@478-485: axes.appen
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`:336-343 [marker-window] - `reports/symbiosis_v6/symbiosis_deep_report.md`:190-197 [marker-window] ### Cluster `83a9f1c3daa7e538` (1 snippets, 1 files) - marker-window@118-125: PROMPT_MARKERS = [ "SYSTEM_PROMPT", "system prompt", "You are", "### Instruction", "###
- `scripts/reports/symbiosis_v6/symbiosis_deep_report.md`:338-345 [marker-window] - `reports/symbiosis_v6/symbiosis_deep_report.md`:198-205 [marker-window] ### Cluster `996c6fa5a889f62f` (1 snippets, 1 files) - marker-window@108-115: ], "sample_previews": [ "marker-window@171-178: PROMPT_MARKERS = [ \"SYSTEM_PROMPT\", \"
- … and 112 more
